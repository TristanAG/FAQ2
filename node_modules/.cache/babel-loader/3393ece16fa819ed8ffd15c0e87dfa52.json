{"ast":null,"code":"import _objectSpread from \"/Users/tristangruener/Desktop/trstn/dev/cashflow_app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/tristangruener/Desktop/trstn/dev/cashflow_app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/tristangruener/Desktop/trstn/dev/cashflow_app/src/components/Expenses.js\";\nimport React from 'react';\nimport FirebaseContext from '../firebase/context';\nimport Expense from './Expense';\n\nfunction Expenses() {\n  const _React$useContext = React.useContext(FirebaseContext),\n        firebase = _React$useContext.firebase,\n        user = _React$useContext.user;\n\n  const _React$useState = React.useState([]),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        expenses = _React$useState2[0],\n        setExpenses = _React$useState2[1];\n\n  const _React$useState3 = React.useState([]),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        total = _React$useState4[0],\n        setTotal = _React$useState4[1];\n\n  React.useEffect(() => {\n    if (user) {\n      const unsubscribe = getExpenses();\n    }\n  }, [user]);\n\n  function getExpenses() {\n    firebase.db.collection('expenses').where(\"postedBy.id\", \"==\", user.uid).orderBy('created', 'desc').onSnapshot(handleSnapshot);\n  }\n\n  function handleSnapshot(snapshot) {\n    const expenses = snapshot.docs.map(doc => {\n      return _objectSpread({\n        id: doc.id\n      }, doc.data());\n    });\n    setExpenses(expenses);\n    getTotal(expenses);\n  } //haha, it's not very pretty, but it works!\n\n\n  function getTotal(expenses) {\n    let total = 0;\n    expenses.map(exp => {\n      const num = parseInt(exp.amount);\n      total += num;\n    });\n    setTotal(total);\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, \"total:\"), \" \", total), React.createElement(\"div\", {\n    className: \"expenses-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, expenses.map((expense, index) => React.createElement(Expense, {\n    key: expense.id,\n    expense: expense,\n    index: index + 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }))));\n}\n\nexport default Expenses;","map":{"version":3,"sources":["/Users/tristangruener/Desktop/trstn/dev/cashflow_app/src/components/Expenses.js"],"names":["React","FirebaseContext","Expense","Expenses","useContext","firebase","user","useState","expenses","setExpenses","total","setTotal","useEffect","unsubscribe","getExpenses","db","collection","where","uid","orderBy","onSnapshot","handleSnapshot","snapshot","docs","map","doc","id","data","getTotal","exp","num","parseInt","amount","expense","index"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,eAAP,MAA4B,qBAA5B;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,SAASC,QAAT,GAAoB;AAAA,4BACSH,KAAK,CAACI,UAAN,CAAiBH,eAAjB,CADT;AAAA,QACVI,QADU,qBACVA,QADU;AAAA,QACAC,IADA,qBACAA,IADA;;AAAA,0BAEcN,KAAK,CAACO,QAAN,CAAe,EAAf,CAFd;AAAA;AAAA,QAEXC,QAFW;AAAA,QAEDC,WAFC;;AAAA,2BAGQT,KAAK,CAACO,QAAN,CAAe,EAAf,CAHR;AAAA;AAAA,QAGXG,KAHW;AAAA,QAGJC,QAHI;;AAKlBX,EAAAA,KAAK,CAACY,SAAN,CAAgB,MAAM;AACpB,QAAIN,IAAJ,EAAU;AACR,YAAMO,WAAW,GAAGC,WAAW,EAA/B;AACD;AACF,GAJD,EAIG,CAACR,IAAD,CAJH;;AAMA,WAASQ,WAAT,GAAuB;AACrBT,IAAAA,QAAQ,CAACU,EAAT,CACGC,UADH,CACc,UADd,EAEGC,KAFH,CAES,aAFT,EAEwB,IAFxB,EAE8BX,IAAI,CAACY,GAFnC,EAGGC,OAHH,CAGW,SAHX,EAGsB,MAHtB,EAIGC,UAJH,CAIcC,cAJd;AAKD;;AAED,WAASA,cAAT,CAAwBC,QAAxB,EAAkC;AAChC,UAAMd,QAAQ,GAAGc,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAkBC,GAAG,IAAI;AACxC;AAASC,QAAAA,EAAE,EAAED,GAAG,CAACC;AAAjB,SAAwBD,GAAG,CAACE,IAAJ,EAAxB;AACD,KAFgB,CAAjB;AAGAlB,IAAAA,WAAW,CAACD,QAAD,CAAX;AACAoB,IAAAA,QAAQ,CAACpB,QAAD,CAAR;AACD,GAzBiB,CA2BlB;;;AACA,WAASoB,QAAT,CAAkBpB,QAAlB,EAA4B;AAC1B,QAAIE,KAAK,GAAG,CAAZ;AACAF,IAAAA,QAAQ,CAACgB,GAAT,CAAcK,GAAD,IAAS;AACpB,YAAMC,GAAG,GAAGC,QAAQ,CAACF,GAAG,CAACG,MAAL,CAApB;AACAtB,MAAAA,KAAK,IAAIoB,GAAT;AACD,KAHD;AAIAnB,IAAAA,QAAQ,CAACD,KAAD,CAAR;AACD;;AAED,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAH,OAAkBA,KAAlB,CADF,EAEE;AAAK,IAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGF,QAAQ,CAACgB,GAAT,CAAa,CAACS,OAAD,EAAUC,KAAV,KACZ,oBAAC,OAAD;AAAS,IAAA,GAAG,EAAED,OAAO,CAACP,EAAtB;AAA0B,IAAA,OAAO,EAAEO,OAAnC;AAA4C,IAAA,KAAK,EAAEC,KAAK,GAAG,CAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADH,CAFF,CADF;AAUD;;AAED,eAAe/B,QAAf","sourcesContent":["import React from 'react'\nimport FirebaseContext from '../firebase/context'\nimport Expense from './Expense'\n\nfunction Expenses() {\n  const { firebase, user } = React.useContext(FirebaseContext)\n  const [expenses, setExpenses] = React.useState([])\n  const [total, setTotal] = React.useState([])\n\n  React.useEffect(() => {\n    if (user) {\n      const unsubscribe = getExpenses()\n    }\n  }, [user])\n\n  function getExpenses() {\n    firebase.db\n      .collection('expenses')\n      .where(\"postedBy.id\", \"==\", user.uid)\n      .orderBy('created', 'desc')\n      .onSnapshot(handleSnapshot)\n  }\n\n  function handleSnapshot(snapshot) {\n    const expenses = snapshot.docs.map(doc => {\n      return { id: doc.id, ...doc.data() }\n    })\n    setExpenses(expenses)\n    getTotal(expenses)\n  }\n\n  //haha, it's not very pretty, but it works!\n  function getTotal(expenses) {\n    let total = 0\n    expenses.map((exp) => {\n      const num = parseInt(exp.amount)\n      total += num\n    })\n    setTotal(total)\n  }\n\n  return (\n    <div>\n      <p><b>total:</b> {total}</p>\n      <div className=\"expenses-list\">\n        {expenses.map((expense, index) => (\n          <Expense key={expense.id} expense={expense} index={index + 1} />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default Expenses\n"]},"metadata":{},"sourceType":"module"}